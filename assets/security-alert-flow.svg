<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg class="svg-diagram" aria-labelledby="title desc" viewBox="0 0 800 600" width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <style>
    .github { fill: #0366d6; }
    .microsoft { fill: #0078d4; }
    .ai { fill: #2ea44f; }
    text { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif; }
    .heading { font-size: 20px; font-weight: bold; }
    .subheading { font-size: 16px; font-weight: bold; }
    .component { font-size: 14px; }
    .watermark { fill: #ccc; }
    
     (prefers-color-scheme: dark) {
      .watermark { fill: #555; }
      text { fill: #fff; }
    }
  </style>
  <title id="title">Security Alert Flow</title>
  <desc id="desc">Diagram showing Security Alert Flow for Nexus Shield Security Playbook</desc>
  <!-- Arrow Definition -->
  <defs>
    <marker id="blueArrow" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#0366d6"/>
    </marker>
    <marker id="msftArrow" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#0078d4"/>
    </marker>
    <marker id="blackArrow" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#24292e"/>
    </marker>
    <marker id="greenArrow" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2ea44f"/>
    </marker>
    <marker id="purpleArrow" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#6600cc"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="400" y="40" text-anchor="middle" font-family="Arial" font-size="22" font-weight="bold">Security Alert Data Flow</text>
  <text x="400" y="70" text-anchor="middle" font-family="Arial" font-size="16" fill="#666666">Nexus Shield Security Ecosystem</text>
  
  <!-- Background Layers -->
  <rect x="50" y="100" width="700" height="150" rx="10" fill="#f0f8ff" stroke="#24292e" stroke-width="1.5" stroke-dasharray="5,5"/>
  <text x="400" y="120" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Developer Ecosystem (GitHub)</text>
  
  <rect x="50" y="270" width="700" height="150" rx="10" fill="#f0f1ff" stroke="#0078d4" stroke-width="1.5" stroke-dasharray="5,5"/>
  <text x="400" y="290" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Security Operations (Microsoft)</text>
  
  <rect x="50" y="440" width="700" height="100" rx="10" fill="#f0fff0" stroke="#2ea44f" stroke-width="1.5" stroke-dasharray="5,5"/>
  <text x="400" y="460" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Automated Response</text>
  
  <!-- Security Alert Source -->
  <rect x="80" y="150" width="150" height="60" rx="5" fill="#ffffff" stroke="#0366d6" stroke-width="2"/>
  <text x="155" y="175" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#0366d6">GitHub Security Alert</text>
  <text x="155" y="195" text-anchor="middle" font-family="Arial" font-size="11" fill="#586069">Scanning Detection</text>
  
  <!-- Alert Enrichment -->
  <rect x="320" y="150" width="160" height="60" rx="5" fill="#ffffff" stroke="#0366d6" stroke-width="2"/>
  <text x="400" y="175" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#0366d6">Alert Enrichment</text>
  <text x="400" y="195" text-anchor="middle" font-family="Arial" font-size="11" fill="#586069">Context Addition</text>
  
  <!-- Webhook Event -->
  <rect x="570" y="150" width="150" height="60" rx="5" fill="#ffffff" stroke="#0366d6" stroke-width="2"/>
  <text x="645" y="175" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#0366d6">Webhook Event</text>
  <text x="645" y="195" text-anchor="middle" font-family="Arial" font-size="11" fill="#586069">JSON Payload</text>
  
  <!-- Logic App -->
  <rect x="570" y="320" width="150" height="60" rx="5" fill="#ffffff" stroke="#0078d4" stroke-width="2"/>
  <text x="645" y="345" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#0078d4">Azure Logic App</text>
  <text x="645" y="365" text-anchor="middle" font-family="Arial" font-size="11" fill="#586069">Event Handling</text>
  
  <!-- Sentinel -->
  <rect x="320" y="320" width="160" height="60" rx="5" fill="#ffffff" stroke="#0078d4" stroke-width="2"/>
  <text x="400" y="345" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#0078d4">Microsoft Sentinel</text>
  <text x="400" y="365" text-anchor="middle" font-family="Arial" font-size="11" fill="#586069">Incident Creation</text>
  
  <!-- Defender -->
  <rect x="80" y="320" width="150" height="60" rx="5" fill="#ffffff" stroke="#0078d4" stroke-width="2"/>
  <text x="155" y="345" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#0078d4">Microsoft Defender</text>
  <text x="155" y="365" text-anchor="middle" font-family="Arial" font-size="11" fill="#586069">Threat Correlation</text>
  
  <!-- GitHub Issue -->
  <rect x="80" y="480" width="150" height="40" rx="5" fill="#ffffff" stroke="#2ea44f" stroke-width="2"/>
  <text x="155" y="505" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#2ea44f">GitHub Issue</text>
  
  <!-- Security Notification -->
  <rect x="320" y="480" width="160" height="40" rx="5" fill="#ffffff" stroke="#2ea44f" stroke-width="2"/>
  <text x="400" y="505" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#2ea44f">Security Notification</text>
  
  <!-- Auto Remediation -->
  <rect x="570" y="480" width="150" height="40" rx="5" fill="#ffffff" stroke="#2ea44f" stroke-width="2"/>
  <text x="645" y="505" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#2ea44f">Auto Remediation</text>
  
  <!-- Flow Lines - CORRIGIDAS -->
  <!-- Level 1 Flow -->
  <line x1="230" y1="180" x2="320" y2="180" stroke="#0366d6" stroke-width="2" marker-end="url(#blueArrow)"/>
  <line x1="480" y1="180" x2="570" y2="180" stroke="#0366d6" stroke-width="2" marker-end="url(#blueArrow)"/>
  
  <!-- Level 1 to Level 2 - AJUSTADAS PARA COR AZUL -->
  <line x1="645" y1="210" x2="645" y2="270" stroke="#0366d6" stroke-width="2" marker-end="url(#blueArrow)"/>
  
  <!-- Conexões verticais da primeira para a segunda camada - AJUSTADAS PARA COR AZUL -->
  <line x1="155" y1="210" x2="155" y2="270" stroke="#0366d6" stroke-width="2" marker-end="url(#blueArrow)"/>
  <line x1="400" y1="210" x2="400" y2="270" stroke="#0366d6" stroke-width="2" marker-end="url(#blueArrow)"/>
  
  <!-- Level 2 Flow -->
  <line x1="570" y1="350" x2="480" y2="350" stroke="#0078d4" stroke-width="2" marker-end="url(#msftArrow)"/>
  <line x1="320" y1="350" x2="230" y2="350" stroke="#0078d4" stroke-width="2" marker-end="url(#msftArrow)"/>
  
  <!-- Sentinel to Actions - AJUSTADAS PARA COR AZUL -->
  <line x1="400" y1="380" x2="400" y2="440" stroke="#0366d6" stroke-width="2" marker-end="url(#blueArrow)"/>
  
  <!-- Defender to GitHub Issue - AJUSTADAS PARA COR AZUL -->
  <line x1="155" y1="380" x2="155" y2="440" stroke="#0366d6" stroke-width="2" marker-end="url(#blueArrow)"/>
  
  <!-- Logic App to Auto Remediation - AJUSTADAS PARA COR AZUL -->
  <line x1="645" y1="380" x2="645" y2="440" stroke="#0366d6" stroke-width="2" marker-end="url(#blueArrow)"/>
  
  <!-- Data Format Labels -->
  <rect x="240" y="150" width="70" height="20" rx="10" fill="#f1f8ff" stroke="#0366d6" stroke-width="1"/>
  <text x="275" y="165" text-anchor="middle" font-family="Arial" font-size="10" fill="#0366d6">JSON</text>
  
  <rect x="490" y="150" width="70" height="20" rx="10" fill="#f1f8ff" stroke="#0366d6" stroke-width="1"/>
  <text x="525" y="165" text-anchor="middle" font-family="Arial" font-size="10" fill="#0366d6">JSON</text>
  
  <rect x="490" y="320" width="70" height="20" rx="10" fill="#f1f8ff" stroke="#0078d4" stroke-width="1"/>
  <text x="525" y="335" text-anchor="middle" font-family="Arial" font-size="10" fill="#0078d4">API</text>
  
  <rect x="240" y="320" width="70" height="20" rx="10" fill="#f1f8ff" stroke="#0078d4" stroke-width="1"/>
  <text x="275" y="335" text-anchor="middle" font-family="Arial" font-size="10" fill="#0078d4">API</text>
  
  <!-- Data Flow Explanations -->
  <g font-family="Arial" font-size="10" fill="#666666">
    <text x="275" y="145" text-anchor="middle">1. Alert Detection</text>
    <text x="525" y="145" text-anchor="middle">2. Event Publishing</text>
    <text x="695" y="265" text-anchor="middle">3. Event Reception</text>
    <text x="525" y="315" text-anchor="middle">4. Security Processing</text>
    <text x="275" y="315" text-anchor="middle">5. Threat Intelligence</text>
    
    <!-- TEXTOS REPOSICIONADOS NO ESPAÇO EM BRANCO -->
    <text x="215" y="435" text-anchor="middle" font-weight="bold">6a. Issue Creation</text>
    
    <text x="460" y="435" text-anchor="middle" font-weight="bold">6b. Team Notification</text>
    
    <text x="705" y="435" text-anchor="middle" font-weight="bold">6c. Automated Fix</text>
  </g>
</svg> 